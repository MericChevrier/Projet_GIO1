<!DOCTYPE html>
<html>
    <head>
        <title>GIO1</title>
        <meta charset="utf-8">
        <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
		<script type="text/javascript" src="https://cdn.jsdelivr.net/gh/openlayers/openlayers.github.io@master/en/v6.4.3/build/ol.js"></script>
		<script src="https://code.jquery.com/jquery-2.2.3.min.js"></script>
        <script type="text/javascript" src="import_geometrie.js"></script>
        <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/openlayers/openlayers.github.io@master/en/v6.4.3/css/ol.css" />
		<link rel="stylesheet" type="text/css" href="style.css" />
		
		
		
		<script type="text/javascript">
		


            
			// Affichage du fond de carte
			function changeBaselayer(layer) {
                console.log("changeBaselayer(\"" + layer + "\")");

                switch (layer) {
                    case "mapbox_rues":
                        mapbox_rues.setVisible(true);
						mapbox_satellite.setVisible(false);
						break;
                    case "mapbox_satellite":
                        mapbox_satellite.setVisible(true);
						mapbox_rues.setVisible(false);
						break;
                    case "blanc":
                        mapbox_satellite.setVisible(false);
						mapbox_rues.setVisible(false);
                        break;
                }
            };


			function LayerVisibility(couche, layer) {
				if (couche == true){
					biend_fonds.setVisible(true);
					}
				else {
					biend_fonds.setVisible(false);
					}
			};
			
        </script>
    </head>
    <body>
		<!--Menu de gauche - situation de base--> 
        <div id="menu_gauche">
			<div id="situation">
				<h1>Situation</h1>
				<p><input type="search" id="search" name="barre_recherche"><button>Recherche</button>
				<h2>Gestion des couches :</h2>
				<h3>Fond de plan</h3>
				<p><label><input type="radio" name="baselayer" value="mapbox_rues" onclick="changeBaselayer(this.value)" checked>Fond Rues</label></p>
				<p><label><input type="radio" name="baselayer" value="mapbox_satellite" onclick="changeBaselayer(this.value)" />Fond Satellite</label></p>
				<p><label><input type="radio" name="baselayer" value="blanc" onclick="changeBaselayer(this.value)" />Fond Blanc</label></p>
				<h3>Mensuration officielle :</h3>
				<p><label><input type="checkBox" name="point_limite" onclick="change_point_limite(this.checked)">Point limite</label></p>
				<p><label><input type="checkBox" name="biend_fonds" onclick="LayerVisibility(this.checked, this.name)">Biend-fonds / DDP</label></p>
				<p><label><input type="checkBox" name="batiment" onclick="change_batiment(this.checked)">Bâtiment</label></p>
				<p><label><input type="checkBox" name="objets_lineaire" onclick="change_objets_lineaire(this.checked)">Objets linéaires</label></p>
				<p><label><input type="checkBox" name="objets_surfacique" onclick="change_objets_surfacique(this.checked)">Objets surfaciques</label></p>
				<p><label><input type="checkBox" name="couverture_du_sol" onclick="changecouverture_du_sol(this.checked)">Couverture du sol</label></p>
				<h3>Restrictions :</h3>
				<p><label><input type="checkBox" name="distances_aux_limites" onclick="change_distances_aux_limites(this.checked)">Distances aux limites</label></p>
				<p><label><input type="checkBox" name="distances_aux_forêt" onclick="change_distances_aux_forêt(this.checked)">Distances aux forêt</label></p>
				<p><label><input type="checkBox" name="distances_cours_deau" onclick="change_distances_cours_deau(this.checked)">Distances aux cours d'eau</label></p>
				<p><label><input type="checkBox" name="alignements_routes" onclick="change_alignements_routes(this.checked)">Alignements routes</label></p>
				<p><label><input type="checkBox" name="aire_implantation" onclick="change_aire_implantation(this.checked)">Aire d'implantation</label></p>
				<p><label><input type="checkBox" name="zone_affectation" onclick="change_zone_affectation(this.checked)">Zone d'affectation</label></p>
				<button type="button" name="import_projet" id="import_projet" onclick="poly_draw()">Importer un nouveau projet</button>
			</div>
		</div>
		
		<!--Menu de droite - information sur le projet--> 
		<div id="menu_droite">
			<div id="information_projet">
				<h1>Information sur le projet</h1>
				<button type="button" name="import_dxf" id="import_dxf" onclick="openFile(dispFile)">Importer la géométrie en .dxf</button>
                <pre id="contents"></pre>
				<h2>Général :</h2>
				<h3>Mensuration officielle :</h3>
				<p><label>Propriétaire :</label></p>
				<p><label>Porteur du projet :</label></p>
				<p><label>Parcelle:</label></p>
				<p><label>Date de mise à l'enquête :</label></p>
				<p><label>Zone d'affectation :</label></p>
				<p><label>Surface de plancher :</label></p>
				<p><label>Surface au sol :</label></p>
				<button type="button" name="validation" id="validation" onclick="poly_draw()">Validation</button>
				<h3>Respect des restrictions 2D :</h3>
				<p><label>Implantation</label></p>
				<p><label>Surface de plancher (xxm² sur xxm²)</label></p>
				<p><label>Surface au sol (xxm² sur xxm²)</label></p>
				<h3>Géométrie 3D :</h3>
				<button type="button" name="3D" id="3D" onclick="poly_draw()">Passer en mode 3D</button>
			</div>
		</div>
	
		
		<div id="map" class="map"></div>
		<script src="lib/proj4.js"></script>
		<script src="lib/proj4-epsg2056.js"></script>
		<script type="text/javascript">	
				
		
		// Carte
            // Vue 
			var map = new ol.Map({
				interactions : ol.interaction.defaults({doubleClickZoom :false}),
				target: "map",
				view: new ol.View({
					projection : ol.proj.get('EPSG:2056'),
					center: ol.proj.fromLonLat([7.40, 46.23]),
					zoom: 12,
				}),
			});
			
			
			//Mapbox Rue
			var mapbox_rues = new ol.layer.Tile({
				source: new ol.source.XYZ({ 
					url: 'https://api.mapbox.com/styles/v1/mapbox/streets-v11/tiles/{z}/{x}/{y}?access_token=pk.eyJ1IjoibWVyaWNjaGV2cmllciIsImEiOiJjazhzbDVvZm4wZDdkM2RvNXI2d2FjdXNxIn0.bje3c5XWbhb_eNI-PTx5cg',
				}),
			});
			
			//Mapbox dark
			var mapbox_satellite = new ol.layer.Tile({
				source: new ol.source.XYZ({ 
					url: 'https://api.mapbox.com/styles/v1/mapbox/satellite-streets-v11/tiles/{z}/{x}/{y}?access_token=pk.eyJ1IjoibWVyaWNjaGV2cmllciIsImEiOiJjazhzbDVvZm4wZDdkM2RvNXI2d2FjdXNxIn0.bje3c5XWbhb_eNI-PTx5cg',
				}),
				visible: false
			});
			


			function AddVerctorLayer(var_name, layer_url){
				var biend_fonds = new ol.layer.Vector({
					source: new ol.source.Vector({
					url: layer_url,
					format: new ol.format.GeoJSON(),
					projection : 'EPSG:2056',
					
					}),
				visible: false,
				});
			map.addLayer(biend_fonds)
			}



			


            // Ajout des couches à la map 
			map.addLayer(mapbox_rues);
			map.addLayer(mapbox_satellite);

			AddVerctorLayer('biend_fonds', 'geojson/MO_BF_Parcelle_WGS84.geojson');
			// AddVerctorLayer('CS_batiment', 'geojson/MO_CS_Batiment_WGS84.geojson');
			
										
		</script>
	</body>
</html>
